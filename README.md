# Проект - Мультимодальные банковские данные юридических лиц

## Описание проекта
Команда Сбербанка опубликовала в open-source самый большой датасет, содержащий мультимодальные банковские данные юридических лиц — Multimodal Banking Dataset (MBD).

Датасет состоит из обезличенных исторических данных, содержащих следующую информацию по клиентам юридических лиц за 12–24 месяцев:

Транзакционная активность (transactions);
Эмбеддинги диалогов (dialogs);
Гео-активность (geostream).
Цель: предсказать для каждого пользователя факт оформления каждого из четырех продуктов в течение месяца после отчетной даты. Исторические данные за 2022 год находятся в targets.

На текущей работе я занимаюсь данными юридических лиц, на основе которых строятся различные склонностные модели в банке. Поэтому было интересно проанализировать, какие данные используются в дополнение к транзакционным на основе этого датасета Сбера, чтобы улучшить качество текущих склонностных моделей в нашем банке.

Содержание датасета
Датасет включает в себя:

Транзакционная активность (transactions): детали прошлых транзакций, включая суммы, типы и даты.
Эмбеддинги диалогов (dialogs): эмбеддинги из взаимодействия с клиентами, которые захватывают семантическую информацию из диалогов.
Гео-активность (geostream): данные о местоположении, представляющие географические паттерны активности клиентов.
Датасет разделен на 5 фолдов на основе client_split (состоящих из равного числа уникальных клиентов) для целей кросс-валидации.

Ссылка на датасет MBD-mini 
https://huggingface.co/datasets/ai-lab/MBD-mini

## Описание полей датасета:

client_split Desc: Splitting clients into folds
* client_id: str Desc: Client id
* fold: int

detail
* dialog Desc: Dialogue embeddings
    * client_id: str Desc: Client id
    * event_time: timestamp Desc: Dialog's date
    * embedding: array float Desc: Dialog's embeddings
    * fold: int
* geo Desc: Geo activity
    * client_id: str Desc: Client id
    * event_time: timestamp Desc: Event datetime
    * fold: int
    * geohash_4: int Desc: Geohash level 4
    * geohash_5: int Desc: Geohash level 5
    * geohash_6: int Desc: Geohash level 6
* trx Desc: Transactional activity
    * client_id: str Desc: Client id
    * event_time: timestamp Desc: Transaction's date
    * amount: float Desc: Transaction's amount
    * fold: int
    * event_type: int Desc: Transaction's type
    * event_subtype: int Desc: Clarifying the transaction type
    * currency: int Desc: Currency
    * src_type11: int Desc: Feature 1 for sender
    * src_type12: int Desc: Clarifying feature 1 for sender
    * dst_type11: int Desc: Feature 1 for contractor
    * dst_type12: int Desc: Clarifying feature 1 for contractor
    * src_type21: int Desc: Feature 2 for sender
    * src_type22: int Desc: Clarifying feature 2 for sender
    * src_type31: int Desc: Feature 3 for sender
    * src_type32: int Desc: Clarifying feature 3 for sender

targets
* mon: str  Desc: Reporting month
* target_1: int Desc: Mark of product issuance in the first reporting month
* target_2: int Desc: Mark of product issuance in the second reporting month
* target_3: int Desc: Mark of product issuance in the third reporting month
* target_4: int Desc: Mark of product issuance in the fourth reporting month
* trans_count: int Desc: Number of transactions
* diff_trans_date: int Desc: Time difference between transactions
* client_id: str Desc: Client id
* fold: int

ptls Desc: Data is similar with detail but in pytorch-lifestream format https://github.com/dllllb/pytorch-lifestream

## Сбор и обработка данных

Загрузка данных: Датасет был загружен с платформы Hugging Face.  
Распаковка и структурирование: Архивные файлы распакованы, проведен обзор содержимого директорий.  
Создание базы данных: Для эффективного хранения и обработки данных большого объема создана база данных SQLite.  
Предварительная обработка: Данные предобработаны и готовы к использованию в моделях машинного обучения.  

## Методы анализа данных  
Анализ распределения переменных: Построены гистограммы для каждой переменной для оценки распределения и выявления выбросов.  
Анализ пропущенных значений: Вычислены доли пропусков по каждой переменной для последующего отбора признаков.  
Статистическое описание: Использованы методы info() и describe() для получения общего представления о данных.  
Анализ по датам: Данные распределены равномерно по датам, без значимых аномалий.   
Анализ по фолдам: Исследована структура данных по фолдам для эффективной организации вычислений и экономии оперативной памяти.   
Проверка корреляции и дубликатов: Выявлены высококоррелированные признаки и дублирующиеся записи для улучшения качества моделей.   

## Выводы и результаты
Качество данных: Данные имеют высокое качество с минимальным количеством пропусков (менее 1%), что приемлемо для моделирования.   
Обезличенность данных: Из-за анонимности данных невозможно провести глубокий анализ отдельных признаков, однако общие тенденции были изучены.   
Распределение данных: Данные распределены нормально, что позволяет использовать стандартные алгоритмы машинного обучения без дополнительных преобразований.   
Эффективное хранение данных: Создание базы данных SQLite обеспечило быстрый доступ к данным и оптимизацию работы с большим объемом информации.   
Автоматизация процесса анализа: Внедрение автоматической проверки качества данных по батчам позволило эффективно выявлять и устранять потенциальные проблемы, экономя ресурсы системы.   
Автоматическая проверка данных и визуализация  
Для обеспечения качества данных была использована автоматическая проверка и визуализация. Были реализованы следующие этапы:   
Проверка на пропущенные значения: составлены SQL-запросы для определения количества пропущенных значений в каждой колонке таблиц.   
Визуализация пропущенных значений: построены графики, отображающие количество пропусков по каждому признаку.  
Проверка уникальности: выявлены дублирующиеся client_id для обеспечения уникальности записей.   
Визуализация дублирующихся client_id: если дубликаты были обнаружены, построены графики для их отображения.  
Проверка диапазонов значений: определены записи с некорректными значениями (например, отрицательными в полях, где это недопустимо).   
Визуализация диапазонов значений: графическое отображение записей с аномальными значениями.   
Закрытие подключения к базе данных: корректное завершение работы с базой данных.   

## Заключение
Проект подтвердил потенциальную ценность использования мультимодальных данных для прогнозирования потребностей клиентов в финансовых продуктах. Дальнейшая работа может быть направлена на разработку и обучение моделей, учитывающих эти дополнительные данные.
